{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.076be90d9f5ab0d22d1c.hot-update.js","sources":["webpack:///./helpers/auth.js"],"sourcesContent":["import cookie from 'js-cookie';\nimport Router from 'next/router';\n\n// set in cookie\nexport const setCookie = (key, value) => {\n    if (process.browser) {\n        cookie.set(key, value, {\n            expires: 1\n        });\n    }\n};\n\n// remove from cookie\nexport const removeCookie = key => {\n    if (process.browser) {\n        cookie.remove(key);\n    }\n};\n\n// get from cookie such as stored token\n// will be useful when we need to make request to server with auth token\nexport const getCookie = (key, req) => {\n    // if (process.browser) {\n    //     return cookie.get(key);\n    // }\n    return process.browser ? getCookieFromBrowser(key) : getCookieFromServer(key, req);\n};\n\nexport const getCookieFromBrowser = key => {\n    return cookie.get(key);\n};\n\nexport const getCookieFromServer = (key, req) => {\n    if (!req.headers.cookie) {\n        return undefined;\n    }\n    // console.log('req.headers.cookie', req.headers.cookie);\n    let token = req.headers.cookie.split(';').find(c => c.trim().startsWith(`${key}=`));\n    if (!token) {\n        return undefined;\n    }\n    let tokenValue = token.split('=')[1];\n    // console.log('getCookieFromServer', tokenValue);\n    return tokenValue;\n};\n\n// set in localstoarge\nexport const setLocalStorage = (key, value) => {\n    if (process.browser) {\n        localStorage.setItem(key, JSON.stringify(value));\n    }\n};\n\n// remove from localstorage\nexport const removeLocalStorage = key => {\n    if (process.browser) {\n        localStorage.removeItem(key);\n    }\n};\n\n// authenticate user by passing data to cookie and localstorage during signin\nexport const authenticate = (response, next) => {\n    setCookie('token', response.data.token);\n    setLocalStorage('user', response.data.user);\n    next();\n};\n\n// access user info from localstorage\nexport const isAuth = () => {\n    if (process.browser) {\n        const cookieChecked = getCookie('token');\n        if (cookieChecked) {\n            if (localStorage.getItem('user')) {\n                return JSON.parse(localStorage.getItem('user'));\n            } else {\n                return false;\n            }\n        }\n    }\n};\n\nexport const logout = () => {\n    removeCookie('token');\n    removeLocalStorage('user');\n    Router.push('/login');\n};\n\nexport const updateUser = (user, next) => {\n    if (process.browser) {\n        if (localStorage.getItem('user')) {\n            let auth = JSON.parse(localStorage.getItem('user'));\n            auth = user;\n            localStorage.setItem('user', JSON.stringify(auth));\n            next();\n        }\n    }\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAGA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}